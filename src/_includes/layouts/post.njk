---
layout: layouts/base.njk
templateClass: tmpl-post
---

<link rel="stylesheet" href="/assets/photoswipe/photoswipe.css">
<script type="module">
  import PhotoSwipeLightbox from '/assets/photoswipe/photoswipe-lightbox.esm.js'; 
  const lightbox = new PhotoSwipeLightbox({
    gallery: '#gallery',
    children: 'a',
    pswpModule: () => import('/assets/photoswipe/photoswipe.esm.js')
  });
  lightbox.init();
</script>

    {% set galleryExists = false %}
    {%- for image in collections.images -%}
      {%- if image.postfolder in page.inputPath -%}
        {% set galleryExists = true %}
      {%- endif -%}
    {%- endfor -%}

    <div class="p-article">
    <div class="p-article_hero">
        {% if page.data.image %}
            <picture>
                <img src="/static/images/{{ page.data.image }}" alt="{{ post.data.imageAlt }}" />
            </picture>
        {% endif %}
        <time class="p-article_date" datetime="{{ page.date | htmlDateString }}">
            {{ page.date | en_readableDate }}
        </time>
        <h1 class="p-article_title">{{ title }}</h1>
        {% if tags %}
          <div class="p-artilce_tags">
            Tagged as: 
            {%- for tag in tags | filterTagList -%}
                {%- set tagUrl %}/tags/{{ tag | slug }}/{% endset -%}
                <a href="{{ tagUrl | url }}" class="c-underline-link"> {{ tag }}</a>
                {% if not loop.last %}
                  | 
                {% endif%}
            {%- endfor %}
          </div>
        {% endif %}
        {% if komoot or strava or links %}
          <div class="p-artilce_tags">
            Shortcuts 
            {% if strava  %}
              <a href="#strava" class="c-underline-link"> &#x2192 Strava</a>
            {% endif %}
            {% if links %}
              <a href="#links" class="c-underline-link"> &#x2192 Links</a>
            {% endif %}
            {% if galleryExists %}
              <a href="#gallery" class="c-underline-link"> &#x2192 Gallery</a>
            {% endif %}
          </div>
        {% endif %}
    </div>

    <div role="main" class="c-content">
        {{ content | safe }}
    </div>

    {%- if galleryExists -%}
      <h1 class="p-article_title">Gallery</h1>
    {%- endif -%}
    <div id="gallery" style="width:100%;column-width:10em;column-gap:8;margin:auto;margin-bottom:2em">
      {% set printGalleryHeader = true %}
      {%- for image in collections.images -%}
        {%- if image.postfolder in page.inputPath -%}
          <a href="../media/{{image.path}}" 
            data-pswp-width="{{image.width}}" 
            data-pswp-height="{{image.height}}" 
            target="_blank">
            <img src="../media/thumbnail-{{image.path}}" style="max-width:200px;margin-top:8px;flex-flow:column-wrap"/>
          </a>
        {%- endif -%}
      {%- endfor -%}
    </div>
        
    {%- if strava -%}
      <div class="p-article_hero" id="strava">
        <h1 class="p-article_title">Strava</h1>
        {%- for stravaItem in strava -%}
            <li><a href="{{stravaItem[1]}}" class="c-underline-link">{{stravaItem[0]}}</a></li>
        {%- endfor -%} 
      </div>
    {%- endif -%}       

    {%- if links -%}
      <div class="p-article_hero" id="links">
        <h1 class="p-article_title">Links</h1>
          <ul>
          {%- for link in links -%}
            <li><a href="{{link[1]}}" class="c-underline-link">{{link[0]}}</a></li>
          {%- endfor -%}
          </ul>
      </div>
    {%- endif -%}

    {%- set nextPost = collections.posts | getNextCollectionItem(page) %}
    {%- set previousPost = collections.posts | getPreviousCollectionItem(page) %}
    {%- if nextPost or previousPost %}
    <div class="c-pagination">
        <ul class="c-pagination_list">
        {%- if nextPost %}
            <li>Next: <a class="c-pagination_link c-underline-link" href="{{ nextPost.url | url }}">{{ nextPost.data.title }}</a></li>
        {% endif %}
        {%- if previousPost %}
            <li>Previous: <a class="c-pagination_link c-underline-link" href="{{ previousPost.url | url }}">{{ previousPost.data.title }}</a></li>
        {% endif %}
        </ul>
    </div>
    {%- endif %}
</div>

<script>
let slideIndex = 1;
showSlides(slideIndex);

function plusSlides(n) {
  showSlides(slideIndex += n);
}

function currentSlide(n) {
  showSlides(slideIndex = n);
}

function sliderKeyPressEvent(e) {
  var keynum;
  if(window.event) { // IE                  
    keynum = e.keyCode;
  } else if(e.which){ // Netscape/Firefox/Opera                 
    keynum = e.which;
  }
  
  if(keynum == 37) { // left
    plusSlides(-1)
  }
  if(keynum == 39) { // right
    plusSlides(1)
  }
}

document.onkeydown = sliderKeyPressEvent;

function showSlides(n) {
  let i;
  let slides = document.getElementsByClassName("mySlides");
  let dots = document.getElementsByClassName("dot");
  if (n > slides.length) {slideIndex = 1}    
  if (n < 1) {slideIndex = slides.length}
  for (i = 0; i < slides.length; i++) {
    slides[i].style.display = "none";  
  }
  for (i = 0; i < dots.length; i++) {
    dots[i].className = dots[i].className.replace(" active", "");
  }
  slides[slideIndex-1].style.display = "block";  
  dots[slideIndex-1].className += " active";
}
</script>

